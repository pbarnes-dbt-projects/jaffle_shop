{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2024-03-12T14:11:24.214257Z", "invocation_id": "e65b9be0-f2e8-48e9-aed4-be8607f1fad5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.094504Z", "completed_at": "2024-03-12T14:11:23.121007Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.122120Z", "completed_at": "2024-03-12T14:11:23.122142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030658960342407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dq_tools.dq_issue_log", "compiled": true, "compiled_code": "with    dummy as (select 1 as col)\n\nselect   cast(null as timestamp) as check_timestamp\n        ,cast(null as TEXT) as table_name\n        ,cast(null as TEXT) as table_query\n        ,cast(null as TEXT) as column_name\n        ,cast(null as TEXT) as ref_table\n        ,cast(null as TEXT) as ref_column\n        ,cast(null as TEXT) as dq_issue_type\n        ,cast(null as TEXT) as invocation_id\n        ,cast(null as TEXT) as dq_model\n        ,cast(null as TEXT) as severity\n        ,cast(null as TEXT) as kpi_category\n        ,cast(null as integer) as no_of_records\n        ,cast(null as integer) as no_of_records_scanned\n        ,cast(null as integer) as no_of_records_failed\n        ,cast(null as integer) as no_of_table_columns\n        ,cast(null as integer) as no_of_tables\n        ,cast(null as TEXT) as test_unique_id\n\nfrom    dummy\n\nwhere   1=0", "relation_name": "penny_sandbox.pbarnes_dbt_core_AUDIT.dq_issue_log"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.124968Z", "completed_at": "2024-03-12T14:11:23.708899Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.710460Z", "completed_at": "2024-03-12T14:11:23.710493Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7768800258636475, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dq_tools.metricflow_time_spine", "compiled": true, "compiled_code": "\n\n--Check https://docs.getdbt.com/docs/build/metricflow-time-spine\n\n\nwith days as (\n\n  \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n     + \n    \n    p13.generated_number * power(2, 13)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n     cross join \n    \n    p as p13\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 10958\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        to_date('01/01/2000','mm/dd/yyyy')\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= to_date('01/01/2030','mm/dd/yyyy')\n\n)\n\nselect * from filtered\n\n\n\n),\n\nfinal as (\n    select cast(date_day as date) as date_day\n    from days\n)\n\nselect * from final", "relation_name": "penny_sandbox.pbarnes_dbt_core.metricflow_time_spine"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.904425Z", "completed_at": "2024-03-12T14:11:23.909087Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.910127Z", "completed_at": "2024-03-12T14:11:23.910140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00819087028503418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_customers", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.913224Z", "completed_at": "2024-03-12T14:11:23.914885Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.915792Z", "completed_at": "2024-03-12T14:11:23.915803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004420042037963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_orders", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.918330Z", "completed_at": "2024-03-12T14:11:23.919714Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.920437Z", "completed_at": "2024-03-12T14:11:23.920446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003677845001220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_payments", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.923097Z", "completed_at": "2024-03-12T14:11:23.926038Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.926678Z", "completed_at": "2024-03-12T14:11:23.926686Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005168914794921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.assert_dollars_spent_are_greater_than_one", "compiled": true, "compiled_code": "", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.928975Z", "completed_at": "2024-03-12T14:11:23.931851Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.932453Z", "completed_at": "2024-03-12T14:11:23.932461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005005836486816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique", "compiled": true, "compiled_code": "", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.934735Z", "completed_at": "2024-03-12T14:11:23.938686Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.939317Z", "completed_at": "2024-03-12T14:11:23.939324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060732364654541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dq_tools.bi_column_analysis", "compiled": true, "compiled_code": "\n\nselect  check_timestamp         as run_time,\n        dq_issue_type           as analysis_name,\n        table_name              as table_name,\n        column_name             as column_name,\n        kpi_category            as kpi_category,\n        'Simple Statistics'     as indicator_category,\n        no_of_records           as rows_processed,\n        no_of_records_failed    as indicator_value\n\nfrom    penny_sandbox.pbarnes_dbt_core_AUDIT.dq_issue_log\n\nqualify row_number() over (\n  partition by  table_name,\n                column_name,\n                ref_table,\n                ref_column,\n                dq_issue_type,\n                date_trunc('day', check_timestamp)\n  order by check_timestamp desc\n) = 1", "relation_name": "penny_sandbox.pbarnes_dbt_core.bi_column_analysis"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.941326Z", "completed_at": "2024-03-12T14:11:23.944257Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.944799Z", "completed_at": "2024-03-12T14:11:23.944805Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00457310676574707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dq_tools.test_coverage", "compiled": true, "compiled_code": "\n\nwith\n\ntest_result as (\n\n  select  *\n          ,concat(table_name, column_name) as column_id\n          ,row_number() over (\n            partition by invocation_id, table_name \n            order by no_of_table_columns desc) as table_column_rn\n\n  from    penny_sandbox.pbarnes_dbt_core_AUDIT.dq_issue_log\n\n  where   coalesce(table_name, '') != ''\n\n),\n\ntest_result_w_coverage_exclusion as (\n\n  select  *\n  from    test_result\n  where   1=1\n    and   (\n      --no database exclusions\n      \n      --no schema exclusions\n      \n      --no table exclusions\n      \n      0=1\n    )\n\n),\n\npre_final as (\n\n  select      invocation_id\n              ,min(check_timestamp) as check_timestamp\n\n              --intermediate measure\n              ,count(distinct column_id) as all_tested_columns\n              ,sum(case when table_column_rn = 1 then no_of_table_columns else 0 end) as all_columns\n              ,count(distinct table_name) as all_tested_tables\n              ,max(no_of_tables) - max(ce.no_of_tables_excluded) as all_tables\n              ,count(distinct test_unique_id) as test_count\n\n              --intermediate pct measure\n              ,avg(no_of_records_scanned) * 100.0 / nullif(avg(no_of_records), 0) as column_record_coverage_pct\n            \n  from        test_result\n  cross join  (\n                --to minus the excluded count to total count of tables\n                select  count(distinct table_name) no_of_tables_excluded\n                from    test_result_w_coverage_exclusion\n              ) as ce\n\n  where     1=1\n    and     column_name is not null\n\n    --coverage exclude by table names\n    and     table_name not in (select table_name from test_result_w_coverage_exclusion)\n\n  group by  1\n\n),\n\nfinal as (\n\n  select  *\n          --intermediate pct measure (cont)\n          ,all_tested_columns * 100.0 / nullif(all_columns, 0) as column_coverage_pct\n          ,all_tested_tables * 100.0 / nullif(all_tables, 0) as model_coverage_pct\n\n          --final measure\n          ,column_record_coverage_pct \n            * (all_tested_columns * 1.0 / nullif(all_columns, 0)) \n            * (all_tested_tables * 1.0 / nullif(all_tables, 0)) as coverage_pct\n          ,test_count * 1.0 / all_columns as test_to_column_ratio\n\n  from    pre_final\n\n)\n\nselect  *\nfrom    final", "relation_name": "penny_sandbox.pbarnes_dbt_core.test_coverage"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.946840Z", "completed_at": "2024-03-12T14:11:23.949100Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.949582Z", "completed_at": "2024-03-12T14:11:23.949589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039539337158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.jaffle_shop.jaffle_shop-on-run-end-0", "compiled": true, "compiled_code": "", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.951170Z", "completed_at": "2024-03-12T14:11:23.953219Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.953675Z", "completed_at": "2024-03-12T14:11:23.953681Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003487825393676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select * from penny_sandbox.pbarnes_dbt_core.raw_customers\n\n),\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "penny_sandbox.pbarnes_dbt_core.stg_customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.955486Z", "completed_at": "2024-03-12T14:11:23.959313Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.959872Z", "completed_at": "2024-03-12T14:11:23.959880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005678892135620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_orders", "compiled": true, "compiled_code": "with source as (\n    select * from penny_sandbox.pbarnes_dbt_core.raw_orders\n\n),\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "penny_sandbox.pbarnes_dbt_core.stg_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.962005Z", "completed_at": "2024-03-12T14:11:23.966378Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.968894Z", "completed_at": "2024-03-12T14:11:23.968900Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008393049240112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select * from penny_sandbox.pbarnes_dbt_core.raw_payments\n\n),\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "penny_sandbox.pbarnes_dbt_core.stg_payments"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.970635Z", "completed_at": "2024-03-12T14:11:23.972914Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.973360Z", "completed_at": "2024-03-12T14:11:23.973366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037970542907714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dq_tools.bi_dq_metrics", "compiled": true, "compiled_code": "\n\nwith dq_metrics_only as (\n\n  select  run_time,\n          analysis_name as rule_name,\n          table_name as data_concept,\n          column_name as data_element,\n          indicator_category,\n          case\n            when coalesce(kpi_category,'') != '' then kpi_category\n            when lower(analysis_name) like '%expression%'        then 'Validity'\n            when lower(analysis_name) like '%recency%'           then 'Timeliness'\n            when lower(analysis_name) like '%accuracy%'\n              or lower(analysis_name) like '%accepted values%'   then 'Accuracy'\n            when lower(analysis_name) like '%uniqueness%'\n              or lower(analysis_name) like '%unique%'            then 'Uniqueness'\n            when lower(analysis_name) like '%null value%'\n              or lower(analysis_name) like '%not null%'          then 'Completeness'\n            when lower(analysis_name) like '%reference integrity%'\n              or lower(analysis_name) like '%relationships%'     then 'Consistency'\n            else 'Other'\n          end as dq_dimension,\n          rows_processed,\n          case\n            when indicator_category in ('Simple Statistics') then indicator_value\n            when indicator_category in ('Pattern Matching') then rows_processed - indicator_value\n            else indicator_value\n          end as rows_failed\n\n  from    penny_sandbox.pbarnes_dbt_core.bi_column_analysis\n\n)\n\nselect  *, rows_processed - rows_failed as rows_passed\nfrom    dq_metrics_only", "relation_name": "penny_sandbox.pbarnes_dbt_core.bi_dq_metrics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.974907Z", "completed_at": "2024-03-12T14:11:23.977995Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.978415Z", "completed_at": "2024-03-12T14:11:23.978420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004797935485839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.accepted_values_bi_column_analysis_indicator_category__Simple_Statistics.ce70296aef", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        indicator_category as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.bi_column_analysis\n    group by indicator_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Simple Statistics'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.980055Z", "completed_at": "2024-03-12T14:11:23.982764Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.983183Z", "completed_at": "2024-03-12T14:11:23.983188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004002094268798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.accepted_values_bi_column_analysis_kpi_category__Validity__Timeliness__Accuracy__Uniqueness__Completeness__Consistency__Other.66b8cded6e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        kpi_category as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.bi_column_analysis\n    group by kpi_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Validity','Timeliness','Accuracy','Uniqueness','Completeness','Consistency','Other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.984501Z", "completed_at": "2024-03-12T14:11:23.989059Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.989471Z", "completed_at": "2024-03-12T14:11:23.989477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005824089050292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_analysis_name.eeee671b07", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect analysis_name\nfrom penny_sandbox.pbarnes_dbt_core.bi_column_analysis\nwhere analysis_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.990796Z", "completed_at": "2024-03-12T14:11:23.993348Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.993752Z", "completed_at": "2024-03-12T14:11:23.993756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037860870361328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_indicator_category.7cabbd7ad4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect indicator_category\nfrom penny_sandbox.pbarnes_dbt_core.bi_column_analysis\nwhere indicator_category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.995039Z", "completed_at": "2024-03-12T14:11:23.997139Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:23.997525Z", "completed_at": "2024-03-12T14:11:23.997530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032668113708496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_indicator_value.bed4c8a078", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect indicator_value\nfrom penny_sandbox.pbarnes_dbt_core.bi_column_analysis\nwhere indicator_value is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:23.998733Z", "completed_at": "2024-03-12T14:11:24.000936Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.001332Z", "completed_at": "2024-03-12T14:11:24.001337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003410816192626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_kpi_category.3358d26745", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_category\nfrom penny_sandbox.pbarnes_dbt_core.bi_column_analysis\nwhere kpi_category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.002596Z", "completed_at": "2024-03-12T14:11:24.004979Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.005373Z", "completed_at": "2024-03-12T14:11:24.005377Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035581588745117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_rows_processed.2d9616c8d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rows_processed\nfrom (select * from penny_sandbox.pbarnes_dbt_core.bi_column_analysis where analysis_name != 'business test') dbt_subquery\nwhere rows_processed is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.006585Z", "completed_at": "2024-03-12T14:11:24.009733Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.010117Z", "completed_at": "2024-03-12T14:11:24.010122Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004348039627075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_run_time.f70275d152", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect run_time\nfrom penny_sandbox.pbarnes_dbt_core.bi_column_analysis\nwhere run_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.011358Z", "completed_at": "2024-03-12T14:11:24.013703Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.014087Z", "completed_at": "2024-03-12T14:11:24.014091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003506183624267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_column_analysis_table_name.a46dd22350", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect table_name\nfrom (select * from penny_sandbox.pbarnes_dbt_core.bi_column_analysis where analysis_name != 'business test') dbt_subquery\nwhere table_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.015325Z", "completed_at": "2024-03-12T14:11:24.017590Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.017998Z", "completed_at": "2024-03-12T14:11:24.018004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034890174865722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_all_columns.3262b5e1be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect all_columns\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere all_columns is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.019269Z", "completed_at": "2024-03-12T14:11:24.021437Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.021816Z", "completed_at": "2024-03-12T14:11:24.021821Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033249855041503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_all_tables.7c396d66bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect all_tables\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere all_tables is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.022984Z", "completed_at": "2024-03-12T14:11:24.025234Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.025720Z", "completed_at": "2024-03-12T14:11:24.025725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035331249237060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_all_tested_columns.f3a497bc54", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect all_tested_columns\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere all_tested_columns is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.027142Z", "completed_at": "2024-03-12T14:11:24.029488Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.029895Z", "completed_at": "2024-03-12T14:11:24.029900Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003673076629638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_all_tested_tables.9f7a4d73cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect all_tested_tables\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere all_tested_tables is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.031181Z", "completed_at": "2024-03-12T14:11:24.033383Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.033771Z", "completed_at": "2024-03-12T14:11:24.033776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003396272659301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_check_timestamp.fd18e654f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect check_timestamp\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere check_timestamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.034985Z", "completed_at": "2024-03-12T14:11:24.037235Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.037652Z", "completed_at": "2024-03-12T14:11:24.037657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034651756286621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_column_coverage_pct.e1e1727a93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect column_coverage_pct\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere column_coverage_pct is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.038933Z", "completed_at": "2024-03-12T14:11:24.041203Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.041586Z", "completed_at": "2024-03-12T14:11:24.041591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034720897674560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_column_record_coverage_pct.95d3dfd0c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect column_record_coverage_pct\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere column_record_coverage_pct is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.042862Z", "completed_at": "2024-03-12T14:11:24.045961Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.046347Z", "completed_at": "2024-03-12T14:11:24.046351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004274129867553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_coverage_pct.f67b37d1ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect coverage_pct\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere coverage_pct is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.047590Z", "completed_at": "2024-03-12T14:11:24.049876Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.050265Z", "completed_at": "2024-03-12T14:11:24.050270Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034902095794677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_invocation_id.b3ebf697f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invocation_id\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere invocation_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.051511Z", "completed_at": "2024-03-12T14:11:24.053826Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.054216Z", "completed_at": "2024-03-12T14:11:24.054221Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003512859344482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_model_coverage_pct.8ff3220b7f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_coverage_pct\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere model_coverage_pct is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.055435Z", "completed_at": "2024-03-12T14:11:24.057613Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.058006Z", "completed_at": "2024-03-12T14:11:24.058011Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003331899642944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_test_count.0190aa6ebb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect test_count\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere test_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.059223Z", "completed_at": "2024-03-12T14:11:24.061402Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.061781Z", "completed_at": "2024-03-12T14:11:24.061786Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003328084945678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_test_coverage_test_to_column_ratio.0b5efdf74c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect test_to_column_ratio\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere test_to_column_ratio is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.063010Z", "completed_at": "2024-03-12T14:11:24.066331Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.066714Z", "completed_at": "2024-03-12T14:11:24.066719Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004511833190917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.unique_test_coverage_invocation_id.15de3c1f63", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invocation_id as unique_field,\n    count(*) as n_records\n\nfrom penny_sandbox.pbarnes_dbt_core.test_coverage\nwhere invocation_id is not null\ngroup by invocation_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.067921Z", "completed_at": "2024-03-12T14:11:24.070105Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.070490Z", "completed_at": "2024-03-12T14:11:24.070495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033249855041503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom penny_sandbox.pbarnes_dbt_core.stg_customers\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.071682Z", "completed_at": "2024-03-12T14:11:24.073780Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.074170Z", "completed_at": "2024-03-12T14:11:24.074174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003244161605834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom penny_sandbox.pbarnes_dbt_core.stg_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.075374Z", "completed_at": "2024-03-12T14:11:24.077612Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.078000Z", "completed_at": "2024-03-12T14:11:24.078004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003414154052734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.stg_orders\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.079297Z", "completed_at": "2024-03-12T14:11:24.082240Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.082628Z", "completed_at": "2024-03-12T14:11:24.082633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004172801971435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom penny_sandbox.pbarnes_dbt_core.stg_orders\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.083819Z", "completed_at": "2024-03-12T14:11:24.085848Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.086223Z", "completed_at": "2024-03-12T14:11:24.086228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031769275665283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom penny_sandbox.pbarnes_dbt_core.stg_orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.087447Z", "completed_at": "2024-03-12T14:11:24.089119Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.089499Z", "completed_at": "2024-03-12T14:11:24.089504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002827167510986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.customers", "compiled": true, "compiled_code": "with customers as (\n\n    select * from penny_sandbox.pbarnes_dbt_core.stg_customers\n\n),\n\norders as (\n\n    select * from penny_sandbox.pbarnes_dbt_core.stg_orders\n\n),\n\npayments as (\n\n    select * from penny_sandbox.pbarnes_dbt_core.stg_payments\n\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        customer_orders.number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n)\n\nselect * from final", "relation_name": "penny_sandbox.pbarnes_dbt_core.customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.090832Z", "completed_at": "2024-03-12T14:11:24.092772Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.093155Z", "completed_at": "2024-03-12T14:11:24.093159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003201007843017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.orders", "compiled": true, "compiled_code": "\n\nwith orders as (\n\n    select * from penny_sandbox.pbarnes_dbt_core.stg_orders\n\n),\n\npayments as (\n\n    select * from penny_sandbox.pbarnes_dbt_core.stg_payments\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        order_payments.credit_card_amount,\n\n        order_payments.coupon_amount,\n\n        order_payments.bank_transfer_amount,\n\n        order_payments.gift_card_amount,\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", "relation_name": "penny_sandbox.pbarnes_dbt_core.orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.094438Z", "completed_at": "2024-03-12T14:11:24.096503Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.096897Z", "completed_at": "2024-03-12T14:11:24.096901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003264904022216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.stg_payments\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','coupon','bank_transfer','gift_card'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.098151Z", "completed_at": "2024-03-12T14:11:24.100328Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.100747Z", "completed_at": "2024-03-12T14:11:24.100752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034122467041015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom penny_sandbox.pbarnes_dbt_core.stg_payments\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.102024Z", "completed_at": "2024-03-12T14:11:24.104260Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.104650Z", "completed_at": "2024-03-12T14:11:24.104654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034189224243164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom penny_sandbox.pbarnes_dbt_core.stg_payments\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.105918Z", "completed_at": "2024-03-12T14:11:24.108465Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.108898Z", "completed_at": "2024-03-12T14:11:24.108903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003820180892944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.accepted_values_bi_dq_metrics_dq_dimension__Validity__Timeliness__Accuracy__Uniqueness__Completeness__Consistency__Other.b32bee5307", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        dq_dimension as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\n    group by dq_dimension\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Validity','Timeliness','Accuracy','Uniqueness','Completeness','Consistency','Other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.110196Z", "completed_at": "2024-03-12T14:11:24.112573Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.112989Z", "completed_at": "2024-03-12T14:11:24.112993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036287307739257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.accepted_values_bi_dq_metrics_indicator_category__Simple_Statistics.cbae39849c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        indicator_category as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\n    group by indicator_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Simple Statistics'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.114331Z", "completed_at": "2024-03-12T14:11:24.124257Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.125237Z", "completed_at": "2024-03-12T14:11:24.125244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011867046356201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.dq_tools_expression_is_true_db_bi_dq_metrics_rows_failed__rows_failed_0.f8c11a12fb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    select\n       *\n    from penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\n    where not rows_failed >= 0\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.127332Z", "completed_at": "2024-03-12T14:11:24.131018Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.131468Z", "completed_at": "2024-03-12T14:11:24.131473Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0053560733795166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.dq_tools_expression_is_true_db_bi_dq_metrics_rows_processed__rows_failed_0.b9d15f8fa8", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    select\n       *\n    from (select * from penny_sandbox.pbarnes_dbt_core.bi_dq_metrics where rule_name != 'business test') dbt_subquery\n    where not rows_failed >= 0\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.132880Z", "completed_at": "2024-03-12T14:11:24.135587Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.135987Z", "completed_at": "2024-03-12T14:11:24.135992Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039751529693603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_data_concept.bf85ad9354", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_concept\nfrom (select * from penny_sandbox.pbarnes_dbt_core.bi_dq_metrics where rule_name != 'business test') dbt_subquery\nwhere data_concept is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.137294Z", "completed_at": "2024-03-12T14:11:24.139787Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.140188Z", "completed_at": "2024-03-12T14:11:24.140193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003712177276611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_dq_dimension.c8dbacdcbb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dq_dimension\nfrom penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\nwhere dq_dimension is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.141450Z", "completed_at": "2024-03-12T14:11:24.143708Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.144108Z", "completed_at": "2024-03-12T14:11:24.144113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034508705139160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_indicator_category.72456fdbac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect indicator_category\nfrom penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\nwhere indicator_category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.145346Z", "completed_at": "2024-03-12T14:11:24.147709Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.148096Z", "completed_at": "2024-03-12T14:11:24.148101Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035419464111328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_rows_failed.b5eb625247", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rows_failed\nfrom penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\nwhere rows_failed is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.149326Z", "completed_at": "2024-03-12T14:11:24.151772Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.152184Z", "completed_at": "2024-03-12T14:11:24.152188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036499500274658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_rows_processed.e667fc8211", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rows_processed\nfrom (select * from penny_sandbox.pbarnes_dbt_core.bi_dq_metrics where rule_name != 'business test') dbt_subquery\nwhere rows_processed is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.153402Z", "completed_at": "2024-03-12T14:11:24.155462Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.155837Z", "completed_at": "2024-03-12T14:11:24.155841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031948089599609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_rule_name.3113b4f46c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rule_name\nfrom penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\nwhere rule_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.156995Z", "completed_at": "2024-03-12T14:11:24.159204Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.159596Z", "completed_at": "2024-03-12T14:11:24.159601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003384113311767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dq_tools.not_null_bi_dq_metrics_run_time.5eadc62c21", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect run_time\nfrom penny_sandbox.pbarnes_dbt_core.bi_dq_metrics\nwhere run_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.160837Z", "completed_at": "2024-03-12T14:11:24.163865Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.164240Z", "completed_at": "2024-03-12T14:11:24.164244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004173755645751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom penny_sandbox.pbarnes_dbt_core.customers\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.165467Z", "completed_at": "2024-03-12T14:11:24.167507Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.167905Z", "completed_at": "2024-03-12T14:11:24.167910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003242969512939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_customers_number_of_orders.a146fc486b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect number_of_orders\nfrom penny_sandbox.pbarnes_dbt_core.customers\nwhere number_of_orders is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.169120Z", "completed_at": "2024-03-12T14:11:24.171164Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.171553Z", "completed_at": "2024-03-12T14:11:24.171558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003236055374145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom penny_sandbox.pbarnes_dbt_core.customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.172859Z", "completed_at": "2024-03-12T14:11:24.176270Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.176671Z", "completed_at": "2024-03-12T14:11:24.176676Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004608154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from penny_sandbox.pbarnes_dbt_core.orders\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.177868Z", "completed_at": "2024-03-12T14:11:24.179891Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.180279Z", "completed_at": "2024-03-12T14:11:24.180284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031719207763671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.181514Z", "completed_at": "2024-03-12T14:11:24.183703Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.184102Z", "completed_at": "2024-03-12T14:11:24.184107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034089088439941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bank_transfer_amount\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere bank_transfer_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.185351Z", "completed_at": "2024-03-12T14:11:24.187661Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.188057Z", "completed_at": "2024-03-12T14:11:24.188062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003567934036254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect coupon_amount\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere coupon_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.189511Z", "completed_at": "2024-03-12T14:11:24.191637Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.192049Z", "completed_at": "2024-03-12T14:11:24.192054Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033919811248779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect credit_card_amount\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere credit_card_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.193264Z", "completed_at": "2024-03-12T14:11:24.195338Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.195723Z", "completed_at": "2024-03-12T14:11:24.195728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003219127655029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.196958Z", "completed_at": "2024-03-12T14:11:24.201405Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.201818Z", "completed_at": "2024-03-12T14:11:24.201823Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005677223205566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gift_card_amount\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere gift_card_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.203067Z", "completed_at": "2024-03-12T14:11:24.205066Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.205462Z", "completed_at": "2024-03-12T14:11:24.205466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031533241271972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.206675Z", "completed_at": "2024-03-12T14:11:24.209078Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.209471Z", "completed_at": "2024-03-12T14:11:24.209476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003576993942260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from penny_sandbox.pbarnes_dbt_core.orders\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from penny_sandbox.pbarnes_dbt_core.customers\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-12T14:11:24.210639Z", "completed_at": "2024-03-12T14:11:24.212713Z"}, {"name": "execute", "started_at": "2024-03-12T14:11:24.213084Z", "completed_at": "2024-03-12T14:11:24.213089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003196239471435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom penny_sandbox.pbarnes_dbt_core.orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.8003220558166504, "args": {"log_file_max_bytes": 10485760, "favor_state": false, "partial_parse_file_diff": true, "invocation_command": "dbt docs generate", "select": [], "log_level_file": "debug", "which": "generate", "populate_cache": true, "indirect_selection": "eager", "quiet": false, "exclude": [], "printer_width": 80, "project_dir": "/Users/pennybarnes/Documents/GitHub/jaffle_shop", "log_format_file": "debug", "static_parser": true, "vars": {}, "log_format": "default", "introspect": true, "show_resource_report": false, "empty_catalog": false, "partial_parse": true, "log_path": "/Users/pennybarnes/Documents/GitHub/jaffle_shop/logs", "macro_debugging": false, "defer": false, "compile": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "send_anonymous_usage_stats": true, "use_colors": true, "static": false, "use_colors_file": true, "enable_legacy_logger": false, "cache_selected_only": false, "write_json": true, "profiles_dir": "/Users/pennybarnes/.dbt", "version_check": true, "strict_mode": false}}